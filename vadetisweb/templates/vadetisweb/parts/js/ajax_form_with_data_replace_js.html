<!-- BEGIN AJAX FORM JS -->
<script type="text/javascript">
function ajaxSubmit(formData, formid) {
    clearFormErrors(formid);
    clearMessages();
    var csrftoken = Cookies.get('csrftoken');
    $.ajax({
        beforeSend: function (xhr, settings) {
            if (!csrfSafeMethod(settings.type) && !this.crossDomain) {
                xhr.setRequestHeader("X-CSRFToken", csrftoken);
            }
        },
        url: $(formid).attr('action'),
        data: new FormData(formData),
        type: $(this).attr('method'),
        enctype: $(this).attr('enctype'),
        processData: false,
        contentType: false,
        success: function (data, status, xhr) {
            handleRedirect(data, xhr);
            handleMessages(data);
            var new_form_inner = $(data).filter('#'+formid).html();
            $('#'+formid).html(new_form_inner);
        },
        error: function (data, status, xhr) {
            printMessages([{'message': "Request failed"}], "error-request");
            handleMessages(data);
        }
    });
}
</script>
<!-- END AJAX FORM JS -->
